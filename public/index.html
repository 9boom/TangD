<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ñ‡∏±‡∏á‡∏î‡∏µ (ThangDee) - Demo ‡πÄ‡∏ï‡πá‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï)</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <style>
        :root {
            --primary: #00c853;
            --primary-dark: #00a843;
            --secondary: #2e7d32;
            --accent: #ffd600;
            --bg: #f5f8f7;
            --card: #ffffff;
            --text: #1a3c34;
            --gray: #6b7c7a;
        }
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: 'Kanit', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }
        .mobile-container {
            width: 100%;
            max-width: 420px;
            min-height: 100vh;
            background: white;
            box-shadow: 0 0 30px rgba(0,0,0,0.15);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        header {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            padding: 16px 20px 24px;
        }
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .user-rank {
            background: rgba(255,255,255,0.25);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.82rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .progress-container {
            margin-top: 16px;
        }
        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            margin-bottom: 6px;
        }
        .progress-bar {
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: var(--accent);
            width: 0%;
            transition: width 0.6s ease;
        }
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
        }
        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 18px;
            margin-bottom: 16px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.06);
            border: 1px solid #eee;
        }
        .btn-main {
            background: var(--primary);
            color: white;
            border: none;
            width: 100%;
            padding: 16px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 500;
            margin: 12px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 16px rgba(0,200,83,0.3);
            transition: all 0.2s;
        }
        .btn-main:active { transform: scale(0.97); }
        .section-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--secondary);
            margin: 24px 0 12px;
        }
        .camera-view {
            background: #111;
            height: 260px;
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
        }
        .scan-line {
            position: absolute;
            width: 100%;
            height: 3px;
            background: var(--primary);
            box-shadow: 0 0 12px var(--primary);
            animation: scan 1.8s infinite linear;
        }
        @keyframes scan {
            0% { top: -3px; }
            50% { top: calc(100% - 3px); }
            100% { top: -3px; }
        }
        .timer {
            font-size: 3.8rem;
            font-weight: bold;
            color: #ff5252;
            text-align: center;
            margin: 20px 0;
        }
        .bottom-nav {
            display: flex;
            background: white;
            border-top: 1px solid #e0e0e0;
            padding: 10px 0;
        }
        .nav-item {
            flex: 1;
            text-align: center;
            color: #999;
            font-size: 0.78rem;
            padding: 6px 0;
            cursor: pointer;
        }
        .nav-item.active {
            color: var(--primary);
            font-weight: 500;
        }
        .nav-item i {
            font-size: 1.5rem;
            margin-bottom: 4px;
            display: block;
        }
        .badge-popup, .info-popup {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }
        .popup-content {
            background: white;
            width: 86%;
            max-width: 360px;
            border-radius: 24px;
            padding: 32px 24px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        .badge-icon { font-size: 4.5rem; margin-bottom: 16px; }
        .map-container {
            height: 240px;
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        .bin-nearby {
            display: flex;
            gap: 12px;
            padding: 12px;
            border-radius: 12px;
            background: #f8fdf8;
            margin-bottom: 10px;
        }
        .history-item {
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.95rem;
        }
        .history-item:last-child { border: none; }

        @media (min-width: 500px) {
            .mobile-container { border-radius: 36px; border: 10px solid #111; }
        }
    </style>
</head>
<body>

<div class="mobile-container">

    <header>
        <div class="header-top">
            <div>
                <h2 style="margin:0;">‡∏ñ‡∏±‡∏á‡∏î‡∏µ <i class="fas fa-recycle"></i></h2>
                <small>‡∏Ç‡∏¢‡∏∞ = ‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥</small>
            </div>
            <div style="text-align:right;">
                <div class="user-rank">
                    <i class="fas fa-medal"></i>
                    <span id="rankName">‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà</span>
                </div>
                <div style="font-weight:bold; margin-top:6px;">
                    <span id="points">0</span> XP
                </div>
            </div>
        </div>
        <div class="progress-container">
            <div class="progress-label">
                <span>Level <span id="level">1</span></span>
                <span>Level <span id="nextLevel">2</span></span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>
    </header>

    <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å -->
    <div id="home" class="content screen active">
        <div class="card" style="text-align:center; border:2px solid var(--primary);">
            <h3>‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏•‡πà‡∏≤‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß!</h3>
            <p style="color:var(--gray);">‡πÄ‡∏à‡∏≠‡∏Ç‡∏ß‡∏î ‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏°‡∏≤‡πÄ‡∏•‡∏¢</p>
            <button class="btn-main" onclick="goTo('scan')">
                <i class="fas fa-camera"></i> ‡∏™‡πÅ‡∏Å‡∏ô‡∏Ç‡∏¢‡∏∞ (AI)
            </button>
        </div>

        <div class="section-title">‡∏ñ‡∏±‡∏á‡πÉ‡∏Å‡∏•‡πâ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</div>
        <div class="card">
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:2rem;color:var(--primary);align-self:center;"></i>
                <div>
                    <div style="font-weight:600;">‡∏ñ‡∏±‡∏á‡∏•‡∏∏‡∏á‡πÄ‡∏≠‡∏Å (‡∏Ç‡∏ß‡∏î+‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á)</div>
                    <div style="font-size:0.85rem;color:var(--gray);">45 ‡∏°. ‚Ä¢ 4.9 ‚òÖ</div>
                </div>
            </div>
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:2rem;color:var(--primary);align-self:center;"></i>
                <div>
                    <div style="font-weight:600;">‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î B ‡∏•‡πá‡∏≠‡∏ö‡∏ö‡∏µ‡πâ</div>
                    <div style="font-size:0.85rem;color:var(--gray);">180 ‡∏°. ‚Ä¢ 4.6 ‚òÖ</div>
                </div>
            </div>
        </div>

        <div class="section-title">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ (TH)</div>
        <div class="card">
            <div class="history-item"><b>1.</b> ‡∏û‡∏µ‡πà‡∏ï‡∏π‡∏ô ‡∏ö‡∏≠‡∏î‡∏µ‡πâ‡∏™‡πÅ‡∏•‡∏° <span style="float:right;color:var(--primary);">6,820 XP</span></div>
            <div class="history-item"><b>2.</b> ‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏¥‡∏ß‡∏™‡∏¥‡∏Å <span style="float:right;color:var(--primary);">5,910 XP</span></div>
            <div class="history-item"><b>‡∏Ñ‡∏∏‡∏ì</b> <span style="float:right;color:var(--primary);" id="myRank">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ‚Äî</span></div>
        </div>
    </div>

    <!-- ‡∏™‡πÅ‡∏Å‡∏ô -->
    <div id="scan" class="content screen">
        <div class="section-title">AI Scanner</div>
        <div class="camera-view" id="cameraView">
            <div class="scan-line"></div>
            <i class="fas fa-wine-bottle fa-4x" style="opacity:0.4;"></i>
            <div style="margin-top:20px;" id="scanStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...</div>
        </div>

        <div id="scanResult" style="display:none; margin-top:20px;">
            <div class="card" id="resultCard">
                <h3 id="itemName" style="color:var(--primary);"></h3>
                <p id="itemDesc"></p>
            </div>
            <button class="btn-main" onclick="goTo('bin')">
                <i class="fas fa-qrcode"></i> ‡∏™‡πÅ‡∏Å‡∏ô‡∏ñ‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°
            </button>
        </div>
    </div>

    <!-- ‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡∏¢‡∏∞ + Timer -->
    <div id="bin" class="content screen">
        <div style="text-align:center; margin:40px 0 20px;">
            <h2>‡∏£‡∏µ‡∏ö‡πÑ‡∏õ‡∏ñ‡∏±‡∏á!</h2>
            <p>‡∏™‡πÅ‡∏Å‡∏ô QR ‡∏ó‡∏µ‡πà‡∏ñ‡∏±‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°</p>
            <div class="timer" id="timer">25</div>
            <p style="color:var(--gray); font-size:0.9rem;">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÇ‡∏Å‡∏á)</p>

            <div class="camera-view" style="height:180px; margin:24px 0;">
                <i class="fas fa-qrcode fa-4x" style="opacity:0.7;"></i>
                <div class="scan-line"></div>
            </div>

            <button class="btn-main" onclick="completeDrop()">
                [‡∏à‡∏≥‡∏•‡∏≠‡∏á] ‡∏™‡πÅ‡∏Å‡∏ô QR ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
            </button>
        </div>
    </div>

    <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà (‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏õ‡πá‡∏ô OpenStreetMap) -->
    <div id="map" class="content screen">
        <div class="section-title">‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á</div>
        <div class="map-container" id="osm-map"></div>
        <div class="card">
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:1.8rem;color:var(--primary);"></i>
                <div>
                    <b>‡∏ñ‡∏±‡∏á‡∏•‡∏∏‡∏á‡πÄ‡∏≠‡∏Å</b><br>
                    <small>45 ‡∏°. ‚Ä¢ ‡∏£‡∏±‡∏ö‡∏Ç‡∏ß‡∏î/‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á ‚Ä¢ 4.9</small>
                </div>
            </div>
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:1.8rem;color:var(--primary);"></i>
                <div>
                    <b>7-11 ‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏ô‡∏ã‡∏≠‡∏¢</b><br>
                    <small>120 ‡∏°. ‚Ä¢ ‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î ‚Ä¢ 4.7</small>
                </div>
            </div>
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:1.8rem;color:var(--primary);"></i>
                <div>
                    <b>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô</b><br>
                    <small>310 ‡∏°. ‚Ä¢ ‡∏Ç‡∏ß‡∏î PET ‚Ä¢ 4.5</small>
                </div>
            </div>
        </div>
    </div>

    <!-- ‡∏•‡∏µ‡∏Å -->
    <div id="league" class="content screen">
        <div class="section-title">‡∏•‡∏µ‡∏Å‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</div>
        <div class="card">
            <div class="history-item"><b>1</b> ‡∏û‡∏µ‡πà‡∏ï‡∏π‡∏ô <span style="float:right">6,820 XP</span></div>
            <div class="history-item"><b>2</b> ‡∏ô‡πâ‡∏≠‡∏á‡∏°‡∏¥‡∏ß <span style="float:right">5,910 XP</span></div>
            <div class="history-item"><b>42</b> ‡∏Ñ‡∏∏‡∏ì <span style="float:right" id="leagueMyPoints">1,250 XP</span></div>
        </div>

        <div class="section-title">‡∏•‡∏µ‡∏Å‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
        <div class="card">
            <div class="history-item"><b>1</b> EcoWarriorTH <span style="float:right">28,400 XP</span></div>
            <div class="history-item"><b>‡∏Ñ‡∏∏‡∏ì</b> <span style="float:right" id="monthMyPoints">‚Äî</span></div>
        </div>
    </div>

    <!-- ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (‡∏£‡∏ß‡∏° owner ‡πÅ‡∏•‡∏∞ dashboard) -->
    <div id="mybins" class="content screen">
        <div class="section-title">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ñ‡∏±‡∏á</div>
        <div class="card">
            <h3>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ñ‡∏±‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
            <div class="history-item">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏¥‡πâ‡∏á: 150 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
            <div class="history-item">XP ‡∏£‡∏ß‡∏°: 12,500</div>
            <div class="history-item">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°: ‡∏Ç‡∏ß‡∏î PET (45%)</div>
        </div>

        <div class="section-title">‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞</div>
        <div class="card" style="text-align:center;">
            <i class="fas fa-trash-alt fa-6x" style="color:var(--primary);"></i>
            <h3>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ñ‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
            <p>‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏ô‡∏ó‡∏¥‡πâ‡∏á‡∏Ç‡∏¢‡∏∞‡∏ó‡∏µ‡πà‡∏ñ‡∏±‡∏á‡∏Ñ‡∏∏‡∏ì!</p>
            <button class="btn-main" onclick="showPopup('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏ñ‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô', 'üóëÔ∏è')">
                <i class="fas fa-plus"></i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ñ‡∏±‡∏á‡πÉ‡∏´‡∏°‡πà
            </button>
        </div>

        <div class="section-title">‡∏ñ‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á</div>
        <div class="card">
            <div class="history-item">‡∏ñ‡∏±‡∏á‡∏•‡∏∏‡∏á‡πÄ‡∏≠‡∏Å <span style="float:right">450 XP ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</span></div>
            <div class="history-item">‡∏ñ‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô <span style="float:right">120 XP ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏ô‡∏µ‡πâ</span></div>
        </div>

        <div class="card">
            <h3>‡∏ñ‡∏±‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÉ‡∏ö</h3>
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:1.8rem;color:var(--primary);"></i>
                <div>
                    <b>‡∏ñ‡∏±‡∏á‡∏•‡∏∏‡∏á‡πÄ‡∏≠‡∏Å</b><br>
                    <small>‡∏ó‡∏¥‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 5 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Ä¢ 4.9 ‚òÖ</small>
                </div>
            </div>
            <div class="bin-nearby">
                <i class="fas fa-trash-can" style="font-size:1.8rem;color:var(--primary);"></i>
                <div>
                    <b>‡∏ñ‡∏±‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡πâ‡∏≤‡∏ô</b><br>
                    <small>‡∏ó‡∏¥‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: 1 ‡∏ä‡∏°.‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ‚Ä¢ 4.7 ‚òÖ</small>
                </div>
            </div>
        </div>
    </div>

    <!-- ‡∏â‡∏±‡∏ô -->
    <div id="profile" class="content screen">
        <div class="card" style="text-align:center;">
            <i class="fas fa-user-circle fa-6x" style="color:var(--primary);"></i>
            <h3 id="profileName">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
            <div>Level <span id="profileLevel">1</span> ‚Ä¢ <span id="profilePoints">0</span> XP</div>
            <button class="btn-main" onclick="switchTab('mybins')">
                <i class="fas fa-trash-alt"></i> ‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô
            </button>
        </div>

        <div class="section-title">Badge ‡∏ó‡∏µ‡πà‡∏™‡∏∞‡∏™‡∏°</div>
        <div class="card" style="text-align:center; color:var(--gray);">
            <i class="fas fa-trophy fa-2x" style="color:gold;"></i><br>
            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Badge (‡∏ó‡∏¥‡πâ‡∏á‡∏Ñ‡∏£‡∏ö 10 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á = ‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏ô‡πÅ‡∏£‡∏Å!)
        </div>

        <div class="section-title">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏¥‡πâ‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
        <div class="card" id="historyList">
            <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ JS -->
        </div>
    </div>

    <!-- Navigation -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home')" id="nav-home">
            <i class="fas fa-home"></i> ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        </div>
        <div class="nav-item" onclick="switchTab('map')" id="nav-map">
            <i class="fas fa-map"></i> ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà
        </div>
        <div class="nav-item" onclick="switchTab('league')" id="nav-league">
            <i class="fas fa-trophy"></i> ‡∏•‡∏µ‡∏Å
        </div>
        <div class="nav-item" onclick="switchTab('profile')" id="nav-profile">
            <i class="fas fa-user"></i> ‡∏â‡∏±‡∏ô
        </div>
    </div>

</div>

<!-- Popups -->
<div class="badge-popup" id="successPopup">
    <div class="popup-content">
        <div class="badge-icon" id="badgeIcon">üèÜ</div>
        <h2 id="popupTitle">‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î!</h2>
        <p id="popupMessage">+50 XP</p>
        <button class="btn-main" onclick="closePopup()">‡∏ï‡∏Å‡∏•‡∏á</button>
    </div>
</div>

<script>
// ========== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô & localStorage ==========
let user = {
    points: 0,
    level: 1,
    history: []
};

function loadUser() {
    const saved = localStorage.getItem('thangdee_user');
    if (saved) {
        user = JSON.parse(saved);
    }
    updateUI();
}

function saveUser() {
    localStorage.setItem('thangdee_user', JSON.stringify(user));
}

function updateUI() {
    document.getElementById('points').textContent = user.points.toLocaleString();
    document.getElementById('profilePoints').textContent = user.points.toLocaleString();
    
    let next = user.level + 1;
    document.getElementById('level').textContent = user.level;
    document.getElementById('nextLevel').textContent = next;
    document.getElementById('profileLevel').textContent = user.level;

    // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì progress (‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡πÉ‡∏ä‡πâ 1000 XP ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ)
    const xpForNext = user.level * 1000;
    const progress = Math.min(99, Math.floor((user.points % xpForNext) / xpForNext * 100));
    document.getElementById('progressFill').style.width = progress + '%';

    // ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏°‡∏°‡∏ï‡∏¥
    document.getElementById('myRank').textContent = `‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${Math.floor(100 - (user.points/100))}`;
    document.getElementById('leagueMyPoints').textContent = user.points.toLocaleString() + ' XP';

    // ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
    const hist = document.getElementById('historyList');
    hist.innerHTML = '';
    if (user.history.length === 0) {
        hist.innerHTML = '<p style="color:#999;text-align:center;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</p>';
    } else {
        user.history.slice(-5).reverse().forEach(item => {
            const div = document.createElement('div');
            div.className = 'history-item';
            div.innerHTML = `${item.date} ‚Ä¢ ${item.item} ‚Ä¢ <b>+${item.xp} XP</b>`;
            hist.appendChild(div);
        });
    }

    // Rank name
    let rank = "‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡∏°‡πà";
    if (user.level >= 10) rank = "‡∏ô‡∏±‡∏Å‡∏£‡∏ö‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°";
    else if (user.level >= 6) rank = "‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå‡πÇ‡∏•‡∏Å";
    else if (user.level >= 3) rank = "‡∏ô‡∏±‡∏Å‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•";
    document.getElementById('rankName').textContent = rank;
}

function addPoints(xp, itemName) {
    user.points += xp;
    const now = new Date().toLocaleString('th-TH', {dateStyle:'short', timeStyle:'short'});
    user.history.push({date: now, item: itemName, xp});
    saveUser();
    updateUI();

    showPopup(`+${xp} XP`, `‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö ${xp} ‡πÅ‡∏ï‡πâ‡∏°‡∏à‡∏≤‡∏Å ${itemName}`, 'üèÜ');
    
    // ‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û?
    const required = user.level * 1000;
    if (user.points >= required * user.level) {
        user.level++;
        saveUser();
        updateUI();
        showPopup('‡πÄ‡∏•‡πÄ‡∏ß‡∏•‡∏≠‡∏±‡∏û!', `‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏•‡πÄ‡∏ß‡∏• ${user.level} ‡πÅ‡∏•‡πâ‡∏ß!`, 'üåü');
    }
}

function showPopup(title, msg, icon) {
    document.getElementById('popupTitle').textContent = title;
    document.getElementById('popupMessage').textContent = msg;
    document.getElementById('badgeIcon').textContent = icon;
    document.getElementById('successPopup').style.display = 'flex';
}

function closePopup() {
    document.getElementById('successPopup').style.display = 'none';
}

// ========== Navigation ==========
function switchTab(tab) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
    
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById('nav-'+tab).classList.add('active');
    
    if (tab === 'home' || tab === 'scan' || tab === 'bin') {
        clearInterval(window.timerInt);
    }

    if (tab === 'map') {
        initMap();
    }
}

// ========== OpenStreetMap Demo ==========
let mapInitialized = false;
function initMap() {
    if (mapInitialized) return;
    
    const map = L.map('osm-map').setView([13.7563, 100.5018], 13); // ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // ‡πÄ‡∏û‡∏¥‡πà‡∏° Marker ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞‡∏à‡∏≥‡∏•‡∏≠‡∏á
    const bins = [
        {lat: 13.7563, lng: 100.5018, name: '‡∏ñ‡∏±‡∏á‡∏•‡∏∏‡∏á‡πÄ‡∏≠‡∏Å'},
        {lat: 13.7600, lng: 100.5050, name: '7-11 ‡∏™‡∏≤‡∏Ç‡∏≤‡πÉ‡∏ô‡∏ã‡∏≠‡∏¢'},
        {lat: 13.7500, lng: 100.5000, name: '‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô'}
    ];

    bins.forEach(bin => {
        L.marker([bin.lat, bin.lng]).addTo(map)
            .bindPopup(bin.name);
    });

    mapInitialized = true;
}

// ========== Flow ‡∏™‡πÅ‡∏Å‡∏ô ‚Üí ‡∏ó‡∏¥‡πâ‡∏á ==========
const items = [
    {name:"‡∏Ç‡∏ß‡∏î PET", xp:50, desc:"‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡πÉ‡∏™ ‡∏™‡∏†‡∏≤‡∏û‡∏î‡∏µ‡∏°‡∏≤‡∏Å!"},
    {name:"‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏≠‡∏∞‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°", xp:40, desc:"‡∏™‡∏∞‡∏≠‡∏≤‡∏î ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•"},
    {name:"‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©", xp:30, desc:"‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏ü‡∏π‡∏Å ‡∏™‡∏†‡∏≤‡∏û‡πÇ‡∏≠‡πÄ‡∏Ñ"},
    {name:"‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß", xp:60, desc:"‡∏Ç‡∏ß‡∏î‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß"},
    {name:"‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", xp:15, desc:"‡∏ñ‡∏∏‡∏á‡∏´‡∏π‡∏´‡∏¥‡πâ‡∏ß‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å"}
];

function goTo(screen) {
    switchTab(screen);
    
    if (screen === 'scan') {
        document.getElementById('scanResult').style.display = 'none';
        document.getElementById('scanStatus').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...';
        
        setTimeout(() => {
            const randomItem = items[Math.floor(Math.random()*items.length)];
            document.getElementById('itemName').textContent = `‡∏û‡∏ö: ${randomItem.name}`;
            document.getElementById('itemDesc').textContent = randomItem.desc + ` (+${randomItem.xp} XP)`;
            window.pendingXP = randomItem.xp;
            window.pendingItem = randomItem.name;
            document.getElementById('scanResult').style.display = 'block';
        }, 2800);
    }
    
    if (screen === 'bin') {
        let time = 25;
        document.getElementById('timer').textContent = time;
        document.getElementById('timer').style.color = '#ff5252';
        
        clearInterval(window.timerInt);
        window.timerInt = setInterval(() => {
            time--;
            document.getElementById('timer').textContent = time;
            if (time <= 5) document.getElementById('timer').style.color = '#d50000';
            if (time <= 0) {
                clearInterval(window.timerInt);
                showPopup('‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤!', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡πÉ‡∏´‡∏°‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î', '‚è∞');
                switchTab('home');
            }
        }, 1000);
    }
}

function completeDrop() {
    clearInterval(window.timerInt);
    if (window.pendingXP) {
        addPoints(window.pendingXP, window.pendingItem);
        window.pendingXP = null;
    }
    switchTab('home');
}

// Init
loadUser();
switchTab('home');

</script>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyDj7CsB4HXMpsPEKjDapoBCVThHYDIFpJ4",
    authDomain: "tangdnetwork.firebaseapp.com",
    projectId: "tangdnetwork",
    storageBucket: "tangdnetwork.firebasestorage.app",
    messagingSenderId: "181333677798",
    appId: "1:181333677798:web:1fdba25b1aaa5ec4e08d27",
    measurementId: "G-MW0RFY703N"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>
</body>
</html>